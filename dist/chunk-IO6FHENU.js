import{a as z}from"./chunk-ZRO2VLPL.js";import{A as q,B as J,C as K,d as A,g as P,h as R,i as F,j as H,k as O,q as D,r as j,s as G,y as U}from"./chunk-NGO3WZC3.js";import"./chunk-QEAK2XWR.js";import{$b as u,$c as B,Eb as a,Fb as o,Gb as f,Kb as E,Lb as x,Mb as s,Vc as L,Xb as C,Yb as p,Zb as _,_b as V,ac as h,bc as w,dc as I,eb as m,gd as W,hd as N,ia as k,na as T,nc as b,tb as y,va as d,vb as g,wa as c}from"./chunk-PYOKKVX2.js";import"./chunk-GAL4ENT6.js";function Q(i,l){if(i&1&&(a(0,"div",18),p(1),o()),i&2){let t=l.data;m(),_(t.nip)}}function X(i,l){if(i&1&&p(0),i&2){let t=l.data;V(" ",t.nama_lengkap," ")}}function Y(i,l){if(i&1&&(a(0,"div",19),p(1),o()),i&2){let t=l.data;m(),_(t.username)}}function Z(i,l){if(i&1&&(a(0,"div"),p(1),o()),i&2){let t=l.data;m(),_(t.email)}}function $(i,l){if(i&1&&(a(0,"span",19),p(1),o()),i&2){let t=l.data;m(),_(t.namaCabang)}}function ee(i,l){if(i&1&&(a(0,"span",19),p(1),o()),i&2){let t=l.data;m(),_(t.role)}}function te(i,l){if(i&1){let t=E();a(0,"button",20),x("click",function(){let e=d(t).data,n=s(),M=C(16);return c(n.openEditModal(e,M))}),p(1," Edit "),o()}}function ne(i,l){i&1&&(a(0,"div"),p(1,"Edit Pegawai"),o())}function ie(i,l){if(i&1&&(a(0,"option",25),p(1),o()),i&2){let t=l.$implicit;g("value",t.id),m(),_(t.namaCabang)}}function ae(i,l){if(i&1&&(a(0,"option",25),p(1),o()),i&2){let t=l.$implicit;g("value",t.nama),m(),_(t.nama)}}function oe(i,l){if(i&1){let t=E();a(0,"div",21)(1,"label",22),p(2,"Cabang"),o(),a(3,"select",23),w("ngModelChange",function(e){d(t);let n=s();return h(n.selectedBranchId,e)||(n.selectedBranchId=e),c(e)}),y(4,ie,2,2,"option",24),o()(),a(5,"div",21)(6,"label",22),p(7,"Role"),o(),a(8,"select",23),w("ngModelChange",function(e){d(t);let n=s();return h(n.selectedRole,e)||(n.selectedRole=e),c(e)}),y(9,ae,2,2,"option",24),o()()}if(i&2){let t=s();m(3),u("ngModel",t.selectedBranchId),m(),g("ngForOf",t.branches),m(4),u("ngModel",t.selectedRole),m(),g("ngForOf",t.roles)}}function le(i,l){if(i&1){let t=E();a(0,"button",26),x("click",function(){d(t),s();let e=C(16);return c(e.close())}),p(1,"Batal"),o(),a(2,"button",27),x("click",function(){d(t);let e=s(),n=C(16);return c(e.saveEmployeeUpdate(n))}),p(3,"Simpan"),o()}}function re(i,l){i&1&&(a(0,"div",28),p(1,"Tambah Pegawai Baru"),o())}function me(i,l){if(i&1&&(a(0,"option",25),p(1),o()),i&2){let t=l.$implicit;g("value",t.id),m(),_(t.namaCabang)}}function pe(i,l){if(i&1&&(a(0,"option",25),p(1),o()),i&2){let t=l.$implicit;g("value",t.id),m(),_(t.nama)}}function se(i,l){if(i&1){let t=E();a(0,"form")(1,"div",29)(2,"span",30),f(3,"i",31),o(),a(4,"input",32),w("ngModelChange",function(e){d(t);let n=s();return h(n.newEmployee.username,e)||(n.newEmployee.username=e),c(e)}),o()(),a(5,"div",29)(6,"span",30),f(7,"i",33),o(),a(8,"input",34),w("ngModelChange",function(e){d(t);let n=s();return h(n.newEmployee.password,e)||(n.newEmployee.password=e),c(e)}),o()(),a(9,"div",29)(10,"span",30),f(11,"i",35),o(),a(12,"input",36),w("ngModelChange",function(e){d(t);let n=s();return h(n.newEmployee.email,e)||(n.newEmployee.email=e),c(e)}),o()(),a(13,"div",29)(14,"span",30),f(15,"i",37),o(),a(16,"input",38),w("ngModelChange",function(e){d(t);let n=s();return h(n.newEmployee.namaLengkap,e)||(n.newEmployee.namaLengkap=e),c(e)}),o()(),a(17,"div",29)(18,"span",30),f(19,"i",39),o(),a(20,"input",40),w("ngModelChange",function(e){d(t);let n=s();return h(n.newEmployee.nip,e)||(n.newEmployee.nip=e),c(e)}),o()(),a(21,"div",29)(22,"span",30),f(23,"i",41),o(),a(24,"select",42),w("ngModelChange",function(e){d(t);let n=s();return h(n.newEmployee.branchId,e)||(n.newEmployee.branchId=e),c(e)}),a(25,"option",43),p(26,"Pilih Cabang"),o(),y(27,me,2,2,"option",24),o()(),a(28,"div",29)(29,"span",30),f(30,"i",44),o(),a(31,"select",45),w("ngModelChange",function(e){d(t);let n=s();return h(n.newEmployee.roleId,e)||(n.newEmployee.roleId=e),c(e)}),a(32,"option",43),p(33,"Pilih Role"),o(),y(34,pe,2,2,"option",24),o()(),a(35,"button",46),x("click",function(){d(t);let e=s(),n=C(24);return c(e.saveNewEmployee(n))}),p(36,"Simpan"),o()()}if(i&2){let t=s();m(4),u("ngModel",t.newEmployee.username),m(4),u("ngModel",t.newEmployee.password),m(4),u("ngModel",t.newEmployee.email),m(4),u("ngModel",t.newEmployee.namaLengkap),m(4),u("ngModel",t.newEmployee.nip),m(4),u("ngModel",t.newEmployee.branchId),m(3),g("ngForOf",t.branches),m(4),u("ngModel",t.newEmployee.roleId),m(3),g("ngForOf",t.roles)}}function de(i,l){if(i&1){let t=E();a(0,"button",47),x("click",function(){d(t),s();let e=C(24);return c(e.close())}),p(1,"Batal"),o()}}var be=(()=>{let l=class l{constructor(){this.http=k(N),this.employees=[],this.rows=[],this.branches=[],this.roles=[],this.loading=!1,this.selectedEmployee=null,this.selectedBranchId="",this.selectedRole="",this.cols=[{title:"NIP",field:"nip"},{title:"Nama Lengkap",field:"nama_lengkap"},{title:"Username",field:"username"},{title:"Email",field:"email"},{title:"Cabang",field:"namaCabang"},{title:"Role",field:"role"},{title:"Actions",field:"actions"}],this.newEmployee={username:"",password:"",email:"",namaLengkap:"",nip:"",branchId:"",roleId:""}}ngOnInit(){this.fetchInitialData()}fetchInitialData(){this.fetchEmployees(),this.fetchBranches(),this.fetchRoles()}fetchEmployees(){this.loading=!0;let r=this.getAuthHeaders();this.http.get("http://34.148.109.190/be/api/employee",{headers:r}).subscribe({next:e=>{this.employees=this.rows=e,this.loading=!1},error:e=>{console.error("Gagal ambil data employee:",e),this.loading=!1}})}fetchBranches(){let r=this.getAuthHeaders();this.http.get("http://34.148.109.190/be/api/employee/branches",{headers:r}).subscribe({next:e=>{this.branches=e.map(n=>({id:n.branchId,namaCabang:n.namaCabang}))},error:e=>console.error("Gagal ambil data cabang:",e)})}fetchRoles(){let r=this.getAuthHeaders();this.http.get("http://34.148.109.190/be/api/employee/roles",{headers:r}).subscribe({next:e=>{this.roles=e.map(n=>({id:n.roleId,nama:n.namaRole}))},error:e=>console.error("Gagal ambil data role:",e)})}openEditModal(r,e){this.selectedEmployee=r,this.selectedBranchId=this.branches.find(n=>n.namaCabang===r.namaCabang)?.id||"",this.selectedRole=this.roles.find(n=>n.nama===r.role)?.nama||"",e.open()}saveEmployeeUpdate(r){if(!this.selectedEmployee)return;let e=this.getAuthHeaders(),n=this.branches.find(v=>v.id===this.selectedBranchId);if(!n){console.error("Cabang tidak ditemukan.");return}let M={branchName:n.namaCabang,roleName:this.selectedRole};this.http.put(`http://34.148.109.190/be/api/employee/${this.selectedEmployee.employeeId}`,M,{headers:e,responseType:"text"}).subscribe({next:()=>{this.fetchEmployees(),r.close(),this.resetModalState()},error:v=>console.error("Gagal update pegawai:",v)})}getAuthHeaders(){let r=localStorage.getItem("token");return new W({Authorization:`Bearer ${r}`})}resetModalState(){this.selectedEmployee=null,this.selectedBranchId="",this.selectedRole=""}openAddModal(r){this.resetNewEmployeeForm(),r.open()}saveNewEmployee(r){let e=this.getAuthHeaders();this.http.post("http://34.148.109.190/be/api/employee/register",this.newEmployee,{headers:e,responseType:"text"}).subscribe({next:()=>{this.fetchEmployees(),r.close(),this.resetNewEmployeeForm()},error:n=>console.error("Gagal tambah pegawai:",n)})}resetNewEmployeeForm(){this.newEmployee={username:"",password:"",email:"",namaLengkap:"",nip:"",branchId:"",roleId:""}}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=T({type:l,selectors:[["app-employee-management"]],standalone:!0,features:[I],decls:31,vars:4,consts:[["modalEdit",""],["modalHeader",""],["modalBody",""],["modalFooter",""],["modalAddEmployee",""],[1,"panel","mt-6","pb-0"],[1,"mb-5","text-lg","font-semibold","dark:text-white-light"],["type","button",1,"btn","btn-primary","mb-4",3,"click"],[1,"datatable"],["skin","whitespace-nowrap bh-table-hover","firstArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M13 19L7 12L13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M16.9998 19L10.9998 12L16.9998 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"lastArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M11 19L17 12L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M6.99976 19L12.9998 12L6.99976 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"previousArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M15 5L9 12L15 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"nextArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M9 5L15 12L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',3,"rows","columns","sortable","loading"],["slot","nip"],["slot","nama_lengkap"],["slot","username"],["slot","email"],["slot","namaCabang"],["slot","role"],["slot","actions"],[1,"modal-top","auth-modal"],[1,"font-medium"],[1,"font-semibold"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"mb-4"],[1,"block","mb-1"],[1,"border","p-2","w-full",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","button",1,"btn","btn-outline-danger","me-2",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"!py-5"],[1,"relative","mb-4"],[1,"absolute","top-1/2","-translate-y-1/2","left-3","text-gray-500"],[1,"fa","fa-user"],["type","text","placeholder","Username","name","employeeUsername","autocomplete","off",1,"form-input","pl-10",3,"ngModelChange","ngModel"],[1,"fa","fa-lock"],["type","password","placeholder","Password","name","employeePassword","autocomplete","new-password",1,"form-input","pl-10",3,"ngModelChange","ngModel"],[1,"fa","fa-envelope"],["type","email","placeholder","Email","name","email",1,"form-input","pl-10",3,"ngModelChange","ngModel"],[1,"fa","fa-id-card"],["type","text","placeholder","Nama Lengkap","name","namaLengkap",1,"form-input","pl-10",3,"ngModelChange","ngModel"],[1,"fa","fa-hashtag"],["type","text","placeholder","NIP","name","nip",1,"form-input","pl-10",3,"ngModelChange","ngModel"],[1,"fa","fa-building"],["name","branchId",1,"form-input","pl-10",3,"ngModelChange","ngModel"],["value",""],[1,"fa","fa-user-tag"],["name","roleId",1,"form-input","pl-10",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-primary","w-full",3,"click"],["type","button",1,"btn","btn-outline-danger","w-full","mt-3",3,"click"]],template:function(e,n){if(e&1){let M=E();a(0,"div")(1,"div",5)(2,"h5",6),p(3,"List Pegawai"),o(),a(4,"button",7),x("click",function(){d(M);let S=C(24);return c(S==null?null:S.open())}),p(5,"Tambah Pegawai"),o(),a(6,"div",8)(7,"ng-datatable",9),y(8,Q,2,1,"ng-template",10)(9,X,1,1,"ng-template",11)(10,Y,2,1,"ng-template",12)(11,Z,2,1,"ng-template",13)(12,$,2,1,"ng-template",14)(13,ee,2,1,"ng-template",15)(14,te,2,0,"ng-template",16),o(),a(15,"ngx-custom-modal",null,0),y(17,ne,2,0,"ng-template",null,1,b)(19,oe,10,4,"ng-template",null,2,b)(21,le,4,0,"ng-template",null,3,b),o(),a(23,"ngx-custom-modal",17,4),y(25,re,2,0,"ng-template",null,1,b)(27,se,37,9,"ng-template",null,2,b)(29,de,2,0,"ng-template",null,3,b),o()()()()}e&2&&(m(7),g("rows",n.rows)("columns",n.cols)("sortable",!0)("loading",n.loading))},dependencies:[B,L,U,O,j,G,A,D,P,R,H,F,K,J,q,z],encapsulation:2});let i=l;return i})();export{be as EmployeeManagementComponent};
