import{a as z}from"./chunk-XYDF42MX.js";import{a as Q}from"./chunk-ZRO2VLPL.js";import{A as G,B as J,C as q,d as D,g as N,j as F,y as H}from"./chunk-NGO3WZC3.js";import"./chunk-QEAK2XWR.js";import{$b as _,$c as W,Eb as i,Fb as o,Kb as v,Lb as f,Mb as d,Ub as y,Vb as S,Wb as T,Wc as V,Xb as A,Yb as s,Zb as u,Zc as R,_c as L,ac as w,bc as h,dc as E,eb as c,gd as B,hd as I,ia as C,lc as k,mc as b,na as M,nc as j,tb as x,va as m,vb as P,wa as g}from"./chunk-PYOKKVX2.js";import"./chunk-GAL4ENT6.js";var O=["modalReview"];function K(t,l){if(t&1&&(i(0,"div",16),s(1),o()),t&2){let n=l.data;c(),u(n.namaCustomer)}}function U(t,l){if(t&1&&(i(0,"div",16),s(1),k(2,"currency"),o()),t&2){let n=l.data;c(),u(b(2,1,n.amount,"IDR"))}}function X(t,l){if(t&1&&(i(0,"div",16),s(1),o()),t&2){let n=l.data;c(),u(n.tenor)}}function Y(t,l){if(t&1&&(i(0,"div",16),s(1),k(2,"date"),o()),t&2){let n=l.data;c(),u(b(2,1,n.tanggalPengajuan,"short"))}}function Z(t,l){if(t&1&&(i(0,"div",16),s(1),o()),t&2){let n=l.data;c(),u(n.status)}}function $(t,l){if(t&1&&(i(0,"div",16),s(1),o()),t&2){let n=l.data;c(),u(n.catatanMarketing)}}function ee(t,l){if(t&1){let n=v();i(0,"button",17),f("click",function(){let e=m(n).data,a=d();return g(a.openReviewModal(e))}),s(1,"Review"),o()}}function te(t,l){t&1&&(i(0,"h3",18),s(1,"Review Pengajuan"),o())}function ne(t,l){if(t&1){let n=v();i(0,"div")(1,"div",20)(2,"label",21),s(3,"Nama Customer"),o(),i(4,"input",22),h("ngModelChange",function(e){m(n);let a=d(2);return w(a.selectedPengajuan.namaCustomer,e)||(a.selectedPengajuan.namaCustomer=e),g(e)}),o()(),i(5,"div",20)(6,"label",21),s(7,"Jumlah Pinjaman"),o(),i(8,"input",22),h("ngModelChange",function(e){m(n);let a=d(2);return w(a.selectedPengajuan.amount,e)||(a.selectedPengajuan.amount=e),g(e)}),o()(),i(9,"div",20)(10,"label",21),s(11,"Tenor"),o(),i(12,"input",22),h("ngModelChange",function(e){m(n);let a=d(2);return w(a.selectedPengajuan.tenor,e)||(a.selectedPengajuan.tenor=e),g(e)}),o()(),i(13,"div",20)(14,"label",21),s(15,"Tanggal Pengajuan"),o(),i(16,"input",22),h("ngModelChange",function(e){m(n);let a=d(2);return w(a.selectedPengajuan.tanggalPengajuan,e)||(a.selectedPengajuan.tanggalPengajuan=e),g(e)}),o()(),i(17,"div",20)(18,"label",21),s(19,"Catatan Manager"),o(),i(20,"textarea",23),h("ngModelChange",function(e){m(n);let a=d(2);return w(a.catatanManager,e)||(a.catatanManager=e),g(e)}),o()(),i(21,"div",24)(22,"button",25),f("click",function(){m(n);let e=d(2);return g(e.submitReview(!0))}),s(23,"Setujui"),o(),i(24,"button",26),f("click",function(){m(n);let e=d(2);return g(e.submitReview(!1))}),s(25,"Tolak"),o()()()}if(t&2){let n=d(2);c(4),_("ngModel",n.selectedPengajuan.namaCustomer),c(4),_("ngModel",n.selectedPengajuan.amount),c(4),_("ngModel",n.selectedPengajuan.tenor),c(4),_("ngModel",n.selectedPengajuan.tanggalPengajuan),c(4),_("ngModel",n.catatanManager)}}function ae(t,l){if(t&1&&x(0,ne,26,5,"div",19),t&2){let n=d();P("ngIf",n.selectedPengajuan)}}function ie(t,l){if(t&1){let n=v();i(0,"button",27),f("click",function(){m(n),d();let e=A(13);return g(e.close())}),s(1,"Tutup"),o()}}var fe=(()=>{let l=class l{constructor(){this.pengajuanService=C(z),this.http=C(I),this.pengajuans=[],this.rows=[],this.loading=!1,this.selectedPengajuan=null,this.catatanManager="",this.cols=[{title:"Nama Customer",field:"namaCustomer"},{title:"Jumlah Pinjaman",field:"amount"},{title:"Tenor",field:"tenor"},{title:"Tanggal Pengajuan",field:"tanggalPengajuan"},{title:"Status",field:"status"},{title:"Catatan Marketing",field:"catatanMarketing"},{title:"Aksi",field:"aksi"}]}ngOnInit(){this.fetchPendingPengajuan()}fetchPendingPengajuan(){this.loading=!0;let r=localStorage.getItem("token");if(!r){alert("Token tidak ditemukan. Anda harus login terlebih dahulu.");return}let e=new B().set("Authorization",`Bearer ${r}`);this.http.get("http://34.148.109.190/be/api/pengajuan/pending-manager",{headers:e}).subscribe({next:a=>{console.log("Data pending pengajuan:",a),this.pengajuans=this.rows=a,this.loading=!1},error:a=>{console.error("Gagal ambil data pengajuan pending:",a),this.loading=!1}})}openReviewModal(r){r?(this.selectedPengajuan=r,this.catatanManager=r.catatanManager||"",console.log("Selected Pengajuan:",this.selectedPengajuan),this.modalReview.open()):console.error("Pengajuan tidak valid:",r)}submitReview(r){if(!this.selectedPengajuan){console.error("Tidak ada pengajuan yang dipilih.");return}let e=this.catatanManager.trim();if(!e){alert("Catatan tidak boleh kosong.");return}let a={disetujui:r,catatan:e};console.log("Payload yang dikirim:",a),this.pengajuanService.approvePengajuan(this.selectedPengajuan.idPengajuan,a).subscribe({next:p=>{console.log("Response:",p.message),alert("Review berhasil dikirim."),this.modalReview.close(),this.fetchPendingPengajuan()},error:p=>{console.error("Gagal kirim review:",p),alert("Gagal mengirim review. Silakan coba lagi.")}})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=M({type:l,selectors:[["app-pengajuan-acc"]],viewQuery:function(e,a){if(e&1&&y(O,5),e&2){let p;S(p=T())&&(a.modalReview=p.first)}},standalone:!0,features:[E],decls:20,vars:4,consts:[["modalReview",""],["modalHeader",""],["modalBody",""],["modalFooter",""],[1,"panel","mt-6","pb-0"],[1,"mb-5","text-lg","font-semibold","dark:text-white-light"],[1,"datatable"],["skin","whitespace-nowrap bh-table-hover","firstArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M13 19L7 12L13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M16.9998 19L10.9998 12L16.9998 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"lastArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M11 19L17 12L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M6.99976 19L12.9998 12L6.99976 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"previousArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M15 5L9 12L15 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"nextArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M9 5L15 12L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',3,"rows","columns","sortable","loading"],["slot","namaCustomer"],["slot","amount"],["slot","tenor"],["slot","tanggalPengajuan"],["slot","status"],["slot","catatanMarketing"],["slot","aksi"],[1,"modal-top","w-[50%]"],[1,"font-semibold"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"text-lg","font-semibold","mb-4"],[4,"ngIf"],[1,"mb-4"],[1,"font-medium"],["type","text","readonly","",1,"w-full","p-2","border","rounded","mt-1",3,"ngModelChange","ngModel"],["rows","4",1,"w-full","p-2","border","rounded","mt-1",2,"border","1px solid #ccc","background-color","#fff",3,"ngModelChange","ngModel"],[1,"flex","justify-between"],[1,"btn","btn-success",3,"click"],[1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-outline-danger",3,"click"]],template:function(e,a){e&1&&(i(0,"div",4)(1,"h5",5),s(2,"List Approval"),o(),i(3,"div",6)(4,"ng-datatable",7),x(5,K,2,1,"ng-template",8)(6,U,3,4,"ng-template",9)(7,X,2,1,"ng-template",10)(8,Y,3,4,"ng-template",11)(9,Z,2,1,"ng-template",12)(10,$,2,1,"ng-template",13)(11,ee,2,0,"ng-template",14),o()()(),i(12,"ngx-custom-modal",15,0),x(14,te,2,0,"ng-template",null,1,j)(16,ae,1,1,"ng-template",null,2,j)(18,ie,2,0,"ng-template",null,3,j),o()),e&2&&(c(4),P("rows",a.rows)("columns",a.cols)("sortable",!0)("loading",a.loading))},dependencies:[W,V,L,R,H,D,N,F,q,J,G,Q],encapsulation:2});let t=l;return t})();export{fe as PengajuanAccComponent};
