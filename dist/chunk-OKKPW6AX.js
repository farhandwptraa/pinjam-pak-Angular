import{a as L}from"./chunk-YSCUJSTB.js";import{a as V}from"./chunk-ZRO2VLPL.js";import{A as j,B as F,C as A,y as T}from"./chunk-NGO3WZC3.js";import"./chunk-QEAK2XWR.js";import{$c as S,Eb as o,Fb as a,Kb as v,Lb as u,Mb as s,Vc as P,Wc as I,Xb as x,Yb as c,Zb as w,_b as M,ca as k,dc as y,eb as m,ha as C,hd as E,ia as b,na as B,nc as _,tb as g,va as d,vb as p,wa as h}from"./chunk-PYOKKVX2.js";import"./chunk-GAL4ENT6.js";var $=(()=>{let n=class n{constructor(t){this.http=t,this.apiUrl="http://34.148.109.190/be/api/wilayah"}getProvincesByBranch(t){return this.http.get(`${this.apiUrl}/branch/${t}/provinsi`)}updateProvincesByBranch(t,i){return this.http.post(`${this.apiUrl}/branch/${t}/provinsi`,i)}getAllProvinces(){return this.http.get(`${this.apiUrl}/provinsi`)}};n.\u0275fac=function(i){return new(i||n)(C(E))},n.\u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();function N(e,n){if(e&1&&(o(0,"div",10),c(1),a()),e&2){let r=n.data;m(),w(r.namaCabang)}}function O(e,n){if(e&1){let r=v();o(0,"button",11),u("click",function(){let i=d(r).data,l=s(),f=x(9);return h(l.openProvinceModal(i,f))}),c(1," Kelola Provinsi "),a()}}function G(e,n){if(e&1&&(o(0,"div",12),c(1),a()),e&2){let r=s();m(),M("Kelola Provinsi untuk: ",r.selectedBranch==null?null:r.selectedBranch.namaCabang,"")}}function U(e,n){e&1&&(o(0,"div")(1,"p"),c(2,"Memuat daftar provinsi..."),a()())}function R(e,n){if(e&1){let r=v();o(0,"label",17)(1,"input",18),u("change",function(){let i=d(r).$implicit,l=s(3);return h(l.toggleProvince(i.id))}),a(),o(2,"span"),c(3),a()()}if(e&2){let r=n.$implicit,t=s(3);m(),p("checked",t.selectedProvinceIds.includes(r.id)),m(2),w(r.name)}}function H(e,n){if(e&1&&(o(0,"div",15),g(1,R,4,2,"label",16),a()),e&2){let r=s(2);m(),p("ngForOf",r.provinces)}}function q(e,n){if(e&1&&g(0,U,3,0,"div",13)(1,H,2,1,"div",14),e&2){let r=s();p("ngIf",r.provinces.length===0),m(),p("ngIf",r.provinces.length>0)}}function z(e,n){if(e&1){let r=v();o(0,"button",19),u("click",function(){d(r),s();let i=x(9);return h(i.close())}),c(1," Batal "),a(),o(2,"button",20),u("click",function(){d(r);let i=s();return h(i.saveProvinces())}),c(3," Simpan "),a()}}var ae=(()=>{let n=class n{constructor(){this.employeeService=b(L),this.branchService=b($),this.branches=[],this.rows=[],this.cols=[{title:"Nama Cabang",field:"namaCabang"},{title:"Alamat",field:"alamat"},{title:"Aksi",field:"aksi"}],this.provinces=[],this.selectedProvinceIds=[],this.selectedBranch=null,this.currentModal=null,this.loading=!1}ngOnInit(){this.loadBranches()}loadBranches(){this.loading=!0,this.employeeService.getBranches().subscribe({next:t=>{this.branches=t,this.rows=t,this.loading=!1},error:t=>{console.error("Gagal mengambil data cabang:",t),this.loading=!1}})}openProvinceModal(t,i){this.selectedBranch=t,this.selectedProvinceIds=[],this.provinces=[],this.currentModal=i,this.branchService.getAllProvinces().subscribe({next:l=>{this.provinces=l,this.branchService.getProvincesByBranch(t.branchId).subscribe({next:f=>{this.selectedProvinceIds=f.map(D=>D.id),i.open()},error:()=>alert("Gagal mengambil provinsi cabang.")})},error:()=>alert("Gagal mengambil daftar provinsi.")})}toggleProvince(t){let i=this.selectedProvinceIds.indexOf(t);i>-1?this.selectedProvinceIds.splice(i,1):this.selectedProvinceIds.push(t)}saveProvinces(){this.selectedBranch&&this.branchService.updateProvincesByBranch(this.selectedBranch.branchId,this.selectedProvinceIds).subscribe({next:()=>{alert("Daftar provinsi berhasil diperbarui!"),this.closeModal()},error:()=>alert("Gagal menyimpan daftar provinsi.")})}closeModal(){this.currentModal?.close(),this.selectedBranch=null,this.selectedProvinceIds=[],this.currentModal=null}};n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=B({type:n,selectors:[["app-branch-management"]],standalone:!0,features:[y],decls:16,vars:4,consts:[["modalKelolaProvinsi",""],["modalHeader",""],["modalBody",""],["modalFooter",""],[1,"panel","mt-6","pb-0"],[1,"mb-5","text-lg","font-semibold","dark:text-white-light"],[1,"datatable"],["skin","whitespace-nowrap bh-table-hover","firstArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M13 19L7 12L13 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M16.9998 19L10.9998 12L16.9998 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"lastArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M11 19L17 12L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> <path opacity="0.5" d="M6.99976 19L12.9998 12L6.99976 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"previousArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M15 5L9 12L15 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',"nextArrow",'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4.5 h-4.5 rtl:rotate-180"> <path d="M9 5L15 12L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/> </svg>',3,"rows","columns","sortable","loading"],["slot","namaCabang"],["slot","aksi"],[1,"font-semibold"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"!py-5"],[4,"ngIf"],["class","provinsi-list",4,"ngIf"],[1,"provinsi-list"],["class","flex items-center space-x-2 mb-2",4,"ngFor","ngForOf"],[1,"flex","items-center","space-x-2","mb-2"],["type","checkbox",3,"change","checked"],["type","button",1,"btn","btn-outline-danger","me-2",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(i,l){i&1&&(o(0,"div")(1,"div",4)(2,"h5",5),c(3,"Manage Cabang"),a(),o(4,"div",6)(5,"ng-datatable",7),g(6,N,2,1,"ng-template",8)(7,O,2,0,"ng-template",9),a()()(),o(8,"ngx-custom-modal",null,0),g(10,G,2,1,"ng-template",null,1,_)(12,q,2,2,"ng-template",null,2,_)(14,z,4,0,"ng-template",null,3,_),a()()),i&2&&(m(5),p("rows",l.rows)("columns",l.cols)("sortable",!0)("loading",l.loading))},dependencies:[S,P,I,T,A,F,j,V]});let e=n;return e})();export{ae as BranchManagementComponent};
